<!DOCTYPE HTML>
<html>
<head>
	<title>nothing to hide</title>
	<style>
		body {
			margin: 0;
			padding: 0;
			background-color: #000000;
		}
	</style>
</head>
<body>
	<canvas id="canvas" style="display:block;width:100%;height:100%"></canvas>
	<img id="kitty" src="kitty.jpeg" style="display:none">
</body>
</html>
	
<script src="engine/lib/pixi.dev.js"></script>
<script src="engine/lib/Stats.js"></script>

<script>

// FPS STATS //
var stats = new Stats();
stats.setMode(0);
stats.domElement.style.position = 'absolute';
stats.domElement.style.left = '0px';
stats.domElement.style.top = '0px';
document.body.appendChild(stats.domElement);

// CREATE STAGE //
var stage = new PIXI.Stage();
var renderer = PIXI.autoDetectRenderer(window.innerWidth, window.innerHeight, null, true, true);

// POPPY SPRITESHEET //
var base = PIXI.BaseTexture.fromImage("200x200_bored_walk.png");
var textures = [];
for(var y=0; y<4; y++){
	for(var x=0; x<5; x++){
		var texture = new PIXI.Texture(base,{x:x*200, y:y*200, width:200, height:200});
		textures.push(texture);
	}
};

// POPPY MOVIECLIP //
var poppies = new PIXI.DisplayObjectContainer();
stage.addChild(poppies);
function addPoppy(){
	var poppy = new PIXI.MovieClip(textures);
	poppy.anchor.x = 0.5;
	poppy.anchor.y = 1;
	poppy.position.x = Math.random()*renderer.width;
	poppy.position.y = Math.random()*renderer.height;
	poppy.animationSpeed = 0.5;
	poppy.gotoAndPlay(Math.floor(Math.random()*poppy.totalFrames));
	poppies.addChild(poppy);
}
for(var i=0;i<100;i++){
	addPoppy();
}

// DRAW LOOP //
canvas.width = renderer.width;
canvas.height = renderer.height;
var ctx = canvas.getContext("2d");
function update(){
	renderer.render(stage);
	ctx.globalCompositeOperation = "source-over";
	ctx.drawImage(kitty,0,0);
	ctx.globalCompositeOperation = "destination-in";
	ctx.drawImage(renderer.view,0,0);
}

// ANIMATE LOOP //
function animate() {
	stats.begin(); update(); stats.end();
	requestAnimFrame(animate);
}
requestAnimFrame(animate);


</script>
